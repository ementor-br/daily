<!DOCTYPE html>
<html>
<link rel="shortcut icon" media="(prefers-color-scheme: light)" href="https://django.e-mentor.com.br/media/favicon.ico">
<link href="https://django.e-mentor.com.br/media/favicon-dark.ico" rel="shortcut icon" media="(prefers-color-scheme: dark)">
<head>
<title>Sala de Mentoria - Daily</title>
</head>
<body>
</body>

<script crossorigin="" src="https://unpkg.com/@daily-co/daily-js"></script>
<script>
      const queryString = window.location.search;
      const urlParams = new URLSearchParams(queryString);
      if (!urlParams.has('id') && !urlParams.has('fl-builder')){
        window.location.replace("https://www.ementor.com.br/error/");
      }
      if (!urlParams.has('fl-builder')){
          const idmentoria = urlParams.get('id');
          let mentoria = false;
          if (!isNaN(idmentoria)) mentoria = true;
          const callFrame = DailyIframe.createFrame({
            iframeStyle: {
              position: 'fixed',
              top: '0px',
              left: 0,
              width: '100%',
              height: '100%',
              borderWidth: '0px',
            },
            theme: {
              colors: {
                accent: "#FFF",
                accentText: "#111111",
                background: "#111111",
                backgroundAccent: "#111111",
                baseText: "#FFF",
                border: "#292929",
                mainAreaBg: "#111111",
                mainAreaBgAccent: "#111111",
                mainAreaText: "#FFF",
                supportiveText: "#FFF",
              },
            },
            showLeaveButton: true,
            showFullscreenButton: false,
            lang: 'pt',
          });
          var waitForEl = function(selector, callback) {
            if (jQuery(selector).length) {
              callback();
            }else{
              setTimeout(function() { waitForEl(selector, callback); }, 500);
            }
          };
          waitForEl($("#haircheck-join"), function() { document.getElementById("haircheck-join").firstChild.innerHTML = "Entrar"; });
          callFrame.join({ url: 'https://ementor.daily.co/'+idmentoria });
          let alertaavaliacao = false;
          let alertafoto = false;
          callFrame.on('participant-counts-updated', (event) => {
            let total = callFrame.participantCounts()['present'] + callFrame.participantCounts()['hidden'];
            if (total > 1 && mentoria) {
              if (!alertaavaliacao){
                alertaavaliacao = true;
                setTimeout(function(){
                  alert("Lembre-se de avaliar a mentoria ao término da sessão. Você será redirecionado automaticamente ao clicar em 'Sair'.")
              }, 2400000);
              }
              if (!alertafoto){
                alertafoto = true;
                setTimeout(function(){
                  alert("Esperamos que tenham uma ótima mentoria. Dica: tire uma foto da sessão e poste nas redes para mostrar que você faz parte da maior comunidade de mentores do Brasil (e não esqueça de marcar a gente: @ementor.br).")
                }, 128000);
              }
            }
          });
          callFrame.on('left-meeting', (event) => {
            if (mentoria) {
              window.alert('Obrigado por realizar uma mentoria na eMentor. Você será redirecionado para o formulário de avaliação da sessão.');
              window.location.href='https://tally.so/r/wzxQ6E?id-mentoria=' + idmentoria;
            }
          });
      }
</script>
  
  </html>
